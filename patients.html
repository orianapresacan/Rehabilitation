<!-- patients.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patients</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/styles.css">

</head>
<body class="bg-white">
    <!-- Header -->
    <nav class="navbar navbar-expand-lg">
        <a class="navbar-brand" href="home.html">
            <img src="static/logo.png" alt="Logo" height="40">
            <span class="navbar-brand-text">MotionCare Solutions</span>
        </a>
        <div class="navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                    <a class="nav-link" href="home.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="patients.html">Patients</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar" class="bg-dark">
            <ul class="list-unstyled components">
                <li>
                    <a href="#" class="text-white">Patient insights</a>
                </li>
                <li>
                    <a href="#" class="text-white">Patient registration</a>
                </li>
                <!-- ... other options ... -->
            </ul>
        </nav>

        <!-- Main content area -->
        <div id="content">
            <!-- Patient Dropdown and Date/Week Selector -->
            <div class="form-group">
                <label for="patient-dropdown">Select a Patient:</label>
                <select id="patient-dropdown" class="form-control">
                    <!-- Patient names will be populated here -->
                </select>
            </div>

			<div class="form-group">
                <label for="week-selector">Select a Week:</label>
                <input type="week" id="week-selector" class="form-control">
            </div>

            <button id="run-button" class="btn btn-primary">RUN</button>

            <!-- Add an iframe element to display the response content for Activities -->
			<iframe id="diagram-iframe" width="100%" height="400" frameborder="0"></iframe>
			
			<!-- Add an iframe element to display the response content for Summary -->
			<iframe id="summary-iframe" width="100%" height="400" frameborder="0"></iframe>

			
        </div>
    </div>
	
	<script>
        // Function to fetch patient names and populate the dropdown
        function fetchPatientNames() {
            fetch('https://test.innovent.site/innovent/patients', {
                headers: {
                    'apikey': 'safe',
                },
            })
                .then(response => response.json())
                .then(data => {
                    const patientDropdown = document.getElementById('patient-dropdown');
                    data.forEach(patient => {
                        const option = document.createElement('option');
                        option.value = patient.username;
                        option.textContent = patient.name;
                        patientDropdown.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error fetching patient names:', error);
                });
        }
		
		function handleRunButtonClick() {
			const selectedPatientName = document.getElementById('patient-dropdown').value;
			const selectedWeek = document.getElementById('week-selector').value;
			const getActivitiesURL = `https://test.innovent.site/innovent/getactivities?username=${selectedPatientName}&week=${selectedWeek}`;
			const getSummaryURL = `https://cdn.kicksdigital.com/depictdatastudio.com/2023/02/GGE_Sample-Graphs.jpg`;

			// Get the iframe elements
			const diagramIframe = document.getElementById('diagram-iframe');
			const summaryIframe = document.getElementById('summary-iframe');

			// Set the sources of the iframes
			diagramIframe.src = getActivitiesURL;
			summaryIframe.src = getSummaryURL;
		}

		document.addEventListener('DOMContentLoaded', () => {
			fetchPatientNames();

			const runButton = document.getElementById('run-button');
			runButton.addEventListener('click', handleRunButtonClick);
		});
    </script>
</body>
</html>
